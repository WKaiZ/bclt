# BCLT Automation Script by Wesley Zheng

This set of scripts automates the process of uploading petition/response documents to ChatGPT, requesting summaries, and recording the responses in a spreadsheet. It minimizes manual intervention and enhances the accuracy of ChatGPT responses compared to batch processing, making the task less tedious than manual handling.

## File Descriptions

- `*.png`: Images used by Python for GUI element recognition.
- `2006/2013/2020/2024` Folders: Specific to the author's use; others can ignore.
- `chatgpt_script.py`: The main script to run. Automates uploading files to ChatGPT and requesting summaries.
- `spreadsheet_script.py` (Optional): Use this if ChatGPT provides unsatisfactory summaries (e.g., includes problem descriptions when instructed not to, summarizes multiple documents in one response, etc.).
- `correction_script.py` (Optional): Similar to `chatgpt_script.py`, but processes only the documents listed in the text file generated by `spreadsheet_script.py`.

## Warnings

1. The script may not run smoothly on macOS. Windows is recommended. You might need to adjust the scripts and grant necessary permissions for the packages used.
2. If an error occurs after identifying petition and response files, it might be due to the area above the ChatGPT prompt box not being white. Scroll down to fix this issue.
3. Keep the ChatGPT window maximized on a monitor. Avoid minimizing or moving it to another monitor to prevent image recognition errors.
4. ChatGPT has a limit of 80 file uploads per 3 hours. After reaching this limit, wait for 3 hours before resuming.
5. Adjust the `counter` variable in the script files to specify the starting line in the spreadsheet to avoid overwriting existing data.

## Instructions

1. Place the petition/response folder within the `bclt` directory.
2. Open a ChatGPT conversation (new or existing). Ensure the area above the chatbox is blank; scroll down if necessary.
3. Replace all images in the repository with screenshots from your computer. Even if they look identical, pixel differences can cause recognition errors. Name the screenshots exactly as in the repository and ensure they closely resemble the originals.
4. Review `chatgpt_script.py`. This is the primary script for summarizing petitions/responses. Modify the following according to your setup:
   - `prompt`: Ensure the correct prompt is used for the document type.
   - `folder`: Name of the folder containing the documents.
   - `year`: Year of the documents to summarize.
   - `paste_text(f"C:\\Users\\wesle\\OneDrive\\Desktop\\bclt\\{year}\\{file_name}")`: Update the path to match your local document path.
   - `wb = load_workbook("outputs_citizens.xlsx")`: Change the spreadsheet name if different.
   - `wb.save("outputs_citizens.xlsx")`: Update accordingly.
     Apply similar changes to the second main function call if present.
5. Run `python chatgpt_script.py`. Refer to the Warnings section for potential errors. You will have to change `year` every time you are done with all the documents corresponding to the previous `year`.
6. After the initial summarization, use `spreadsheet_script.py` to address any issues where ChatGPT didn't follow instructions. Replace the `.txt` and `.xlsx` filenames with those relevant to your folder.
7. Run `spreadsheet_script.py`. Consult the Warnings section for common errors.
8. To reprocess specific files, use `correction_script.py`. Ensure the files are valid. No changes are needed if the files are correctly specified. Run `correction_script.py`.
9. The final summaries will be in `output_responses.xlsx` and `output_citizens.xlsx`, ready for submission.
